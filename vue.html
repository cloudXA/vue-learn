<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="./node_modules/./vue/dist/vue.js"></script>
    <title>Document</title>

</head>
<body>
  <div id="app">
    <!-- vue2.0 代码复用和抽象的主要形式是组件，然而仍然需要对普通DOM元素进行底层操作，这时候就会用到自定义指令
      -->
      <div id="hook-arguments-example" v-demo:foo.a.b = 'message'></div>
      
  </div>


<script>

  // 一个指令定义对象可以提供如下几个钩子函数
  // - bind: 只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置
  // - inserted: 被绑定元素插入父节点时调用（仅保证父节点存在，但不一定已被插入文档中）
  // - update: 所在组件的vNode跟新时调用，但是可能发生其子vNode跟新之前。指令的值可能发生了改变，
  // 也可能没有。但是你可以通过比较封信前后的值来忽略不必要的模板更新
// - componentUpdated: 指令所在组件的vNode及其子vNode全部更新后调用
// - unbind: 只调用一次，指令与元素解绑时调用

  // 钩子函数参数
    // 指令钩子函数会被传入以下参数
      // - el 指令所绑定的元素，用来直接操作DOM
      // - binding: 一个对象，包含以下属性
      //     - name: 指令名， 不包括v-前缀
      //     - value: 指令的绑定值， v-my-direvtive="1+1" ,绑定值为2
      //     - oldValue：指令绑定的前一个值，仅在update和componentUpdated钩子中可用，无论值是否改变都可用
      //     - expression 字符串形式的指令表达式，例如v-my-directives = '1+1'表达式为'1+1'
      //     - arg: 传给指令的参数，可选，例如v-my-directive: foo 中，参数为foo
      //     - modifiers: 一个包含修饰符的对象。 v-my-directive.foo.bar中，修饰符对象为{ foo: true, bar: true}
      //     - vnode Vue编译生成的虚拟节点，
      //     - oldVnode 上一个虚拟节点，仅在update和componentUpdate钩子中可用

  // 除了el之外，其他参数都应该是只读的，切勿进行修改。如果需要在钩子之间共享数据，建议通过元素
  // 的dataset来进行


    // 注册一个全局自定义指令v-focus 
    Vue.directive('demo', {
      bind(el, binding, vnode) {
        var s = JSON.stringify
        el.innerHTML = 
          'name:'        + s(binding.name) + '<br>' + 
          'value:'       + s(binding.value) + '<br>' + 
          'expression:'  + s(binding.expression) + '<br>' + 
          'argument:'    +  s(binding.arg) + '<br>' + 
          'modifiers:'   + s(binding.modifiers) + '<br>' + 
          'vnode keys:'  + Object.keys(vnode).join('---')
      }
      
    })

    var vm = new Vue({
      el: '#hook-arguments-example',
      data: {
        message: '你好'
      }
      
      

    })
</script>

</body>


